@{
    ViewData["Title"] = "Criação de Simulado";
}

<h4 class="mb-4">Tela Criação Simulado</h4>

<form id="formCriarSimulado">
    <div class="mb-4">
        <h5>Áreas de interesse</h5>
        <div class="form-check">
            <input class="form-check-input area-interesse" type="checkbox" value="matematica" id="checkMatematica">
            <label class="form-check-label" for="checkMatematica">Matemática</label>
        </div>
        <div class="form-check">
            <input class="form-check-input area-interesse" type="checkbox" value="humanas" id="checkHumanas">
            <label class="form-check-label" for="checkHumanas">Ciências Humanas</label>
        </div>
        <div class="form-check">
            <input class="form-check-input area-interesse" type="checkbox" value="natureza" id="checkNatureza">
            <label class="form-check-label" for="checkNatureza">Ciências Natureza</label>
        </div>
        <div class="form-check">
            <input class="form-check-input area-interesse" type="checkbox" value="linguagens" id="checkLinguagens">
            <label class="form-check-label" for="checkLinguagens">Linguagens</label>
        </div>
    </div>

    <div class="mb-4">
        <h5>Anos</h5>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="tipoAnos" id="anosTodos" value="todos" checked>
            <label class="form-check-label" for="anosTodos">Todos</label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="tipoAnos" id="anosEspecificos" value="especificos" data-bs-toggle="modal" data-bs-target="#modalAnos">
            <label class="form-check-label" for="anosEspecificos">Específicos...</label>
        </div>
        <input type="hidden" id="anosSelecionados" name="anosSelecionados" />
    </div>

    <div class="mb-3">
        <label for="numeroQuestoes" class="form-label">Insira o número de questões</label>
        <input type="number" class="form-control" id="numeroQuestoes" placeholder="Ex: 10, 50, 180" max="180">
    </div>

    <div class="mb-4">
        <label for="nomeSimulado" class="form-label">Insira o nome do simulado</label>
        <input type="text" class="form-control" id="nomeSimulado" placeholder="Máximo de 30 caracteres" maxlength="30">
    </div>

    <div class="d-flex justify-content-between">
        <button type="button" class="btn btn-outline-secondary">? Ajuda</button>
        <button id="btnConfirmar" type="submit" class="btn btn-primary" disabled>Criar Simulado</button>
    </div>
</form>

<partial name="ModalAnos" />


@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('formCriarSimulado');
            const btnConfirmar = document.getElementById('btnConfirmar');
            const nomeSimuladoInput = document.getElementById('nomeSimulado');
            const numeroQuestoesInput = document.getElementById('numeroQuestoes');
            const areasCheckboxes = document.querySelectorAll('.area-interesse');

            function validarFormulario() {
                const nomeValido = nomeSimuladoInput.value.trim().length > 0;
                const questoesValidas = parseInt(numeroQuestoesInput.value, 10) > 0;
                const areaSelecionada = Array.from(areasCheckboxes).some(cb => cb.checked);

                // Habilita o botão apenas se todos os critérios forem atendidos
                btnConfirmar.disabled = !(nomeValido && questoesValidas && areaSelecionada);
            }

            // Adiciona listeners para validar em tempo real
            nomeSimuladoInput.addEventListener('input', validarFormulario);
            numeroQuestoesInput.addEventListener('input', validarFormulario);
            areasCheckboxes.forEach(cb => cb.addEventListener('change', validarFormulario));

            // Lógica para o modal de anos
            const radioAnosEspecificos = document.getElementById('anosEspecificos');
            const radioAnosTodos = document.getElementById('anosTodos');
            const modalAnos = new bootstrap.Modal(document.getElementById('modalAnos'));

            // Previne que o rádio mude se o modal for cancelado
            radioAnosEspecificos.addEventListener('click', function(e) {
                 if (!document.getElementById('anosSelecionados').value) {
                    radioAnosTodos.checked = true; // Mantém "Todos" selecionado
                 }
            });

             document.getElementById('btnConfirmaAnos').addEventListener('click', function() {
                const anosInput = document.getElementById('inputAnos');
                document.getElementById('anosSelecionados').value = anosInput.value;
                if(anosInput.value) {
                    radioAnosEspecificos.checked = true;
                }
                modalAnos.hide();
             });
        });
    </script>
}